<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø®Ø±ÙŠØ·Ø© Ø§Ù„ÙÙ„ÙƒÙŠØ©</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap');
        * { margin:0; padding:0; box-sizing:border-box; font-family: 'Cairo','Tahoma',sans-serif; }

        body{
            direction: rtl;
            min-height:100vh;
            padding:20px 15px;
            /* Ø®Ù„ÙÙŠØ© Ø³Ù…Ø§Ø¡ Ø§Ù„Ù„ÙŠÙ„ */
            background: linear-gradient(180deg, #1A233A 0%, #2A385C 100%);
            color:#333;
            position:relative;
            overflow-x:hidden;
        }
        
        /* ØªØ£Ø«ÙŠØ± Ø§Ù„Ù†Ø¬ÙˆÙ… */
        body::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            min-height: 1200px;
            background: transparent;
            box-shadow: 
                100px 100px 1px 1px #FFD700, 200px 300px 1px 1px #fff, 400px 500px 1px 1px #FFD700, 
                600px 100px 1px 1px #fff, 800px 400px 1px 1px #FFD700, 1000px 200px 1px 1px #fff, 
                1200px 500px 1px 1px #FFD700, 100px 800px 1px 1px #fff, 300px 900px 1px 1px #FFD700, 
                500px 700px 1px 1px #fff, 700px 600px 1px 1px #FFD700, 900px 800px 1px 1px #fff, 
                150px 500px 5px 5px rgba(255, 215, 0, 0.9),
                550px 800px 3px 3px rgba(255, 255, 255, 0.9), 
                950px 150px 5px 5px rgba(255, 215, 0, 0.9);
            z-index: 1; 
            opacity: 1;
        }

        .container { max-width:900px; width:100%; margin:0 auto; position:relative; z-index:2;
        }

        .header-section{
            padding: 40px 10px 30px;
            text-align: center;
            color: #F5F3FF;
        }
        .header-section h1{
            font-size:36px;
            font-weight:700; color:#F5F3FF;
            text-shadow: 0 0 8px rgba(255,255,255,0.12);
            margin-bottom:8px;
        }
        .header-section p{ color:#E8E1FF; max-width:600px;
            margin:0 auto; line-height:1.7; }

        .calculator-box{
            width:100%;
            max-width:700px; /* ØªÙ‚ÙŠÙŠØ¯ Ø¹Ø±Ø¶ Ø§Ù„Ø­Ø§Ø³Ø¨Ø© */
            margin: 0 auto 40px;
            padding:28px;
            background: rgba(255,255,255,0.12); /* Ø®Ù„ÙÙŠØ© Ø´ÙØ§ÙØ© Ø¯Ø§Ø®Ù„ÙŠØ© */
            border-radius:18px;
            backdrop-filter: blur(5px);
            box-shadow: 0 4px 30px rgba(0,0,0,0.15);
            border:1px solid rgba(255,255,255,0.1);
        }
        .box-title{ 
            text-align:center; 
            color:#FFD700; /* Ù„ÙˆÙ† Ø°Ù‡Ø¨ÙŠ Ù„Ù„Ø¹Ù†ÙˆØ§Ù† */
            font-weight:700; 
            margin-bottom:20px;
            font-size: 24px;
            text-shadow: 0 0 5px rgba(255,215,0,0.5);
        }

        /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ */
        form { width:100%; margin:0; }
        .form-row { display:grid; grid-template-columns: repeat(4,1fr); gap:15px; margin-bottom:18px; }
        .form-row.double { grid-template-columns: 1fr 1fr; }
        .form-group { position:relative; }
        
        label { 
            display:block; 
            font-size:14px; 
            font-weight:700; 
            color:#F0F0F0; /* Ù„ÙˆÙ† ÙØ§ØªØ­ Ù„ØªÙ†Ø§Ø³Ù‚ Ø§Ù„Ø®Ù„ÙÙŠØ© Ø§Ù„Ø¯Ø§ÙƒÙ†Ø© */
            margin-bottom:6px;
        }
        
        input, select {
            width:100%;
            padding:12px; 
            border:1px solid #4A567A; 
            border-radius:8px;
            font-size:16px; 
            background:#1A233A; /* Ø®Ù„ÙÙŠØ© Ø¯Ø§ÙƒÙ†Ø© Ù„Ù„Ø­Ù‚ÙˆÙ„ */
            color:#fff; 
            transition: box-shadow .2s, border-color .2s;
        }
        input:focus, select:focus { 
            outline:none; 
            border-color:#BA55D3; 
            box-shadow:0 0 10px rgba(186,85,211,0.5);
        }

        .btn{
            display:block;
            width:100%;
            padding:14px;
            border-radius:8px;
            border:none;
            /* ØªØ¯Ø±Ø¬ Ù„ÙˆÙ†ÙŠ Ø¨Ù†ÙØ³Ø¬ÙŠ Ù„Ø§Ù…Ø¹ */
            background: linear-gradient(90deg,#9370DB 0%,#BA55D3 100%);
            color:#fff; 
            font-size:20px; 
            font-weight:700; 
            cursor:pointer;
            margin-top:20px;
            box-shadow: 0 4px 15px rgba(186,85,211,0.4);
            transition: transform .18s, box-shadow .18s;
        }
        .btn:hover{ 
            transform: translateY(-2px); 
            box-shadow: 0 8px 25px rgba(186,85,211,0.6);
        }

        .error {
            color:#FFEBEE;
            background:#D32F2F; 
            padding:10px; 
            border-radius:8px;
            margin:15px auto; 
            max-width:600px; 
            font-weight:700; 
            border:1px solid #EF9A9A;
            text-align: center;
        }

        /* Ù‚Ø³Ù… Ø§Ù„Ù†ØªØ§Ø¦Ø¬ */
        .result{ 
            max-width:900px; 
            margin:30px auto 60px; 
            background:rgba(255,255,255,0.98); 
            padding:25px; 
            border-radius:18px; 
            box-shadow:0 10px 30px rgba(0,0,0,0.1);
            border:1px solid #EEE; 
        }
        .info-box{ 
            background:#F0F4F8; 
            padding:15px; 
            border-radius:10px; 
            text-align:center; 
            color:#444; 
            margin-bottom:20px;
            font-size: 15px;
        }

        table{ 
            width:100%; 
            border-collapse:collapse; 
            font-size:15px; 
            margin-top:20px;
        }
        th, td{ 
            padding:12px 8px; 
            border:1px solid #E5E5E5; 
            text-align:center;
        }
        th{ 
            background:#E8E1FF; 
            color:#6A5ACD; 
            font-weight:700;
        }
        tr:nth-child(even) { 
            background:#F9F9F9;
        }
        tr:hover { 
            background:#F3F3F3;
        }

        .result h2, .result h3 { 
            color:#6A5ACD; 
            margin-top:30px; 
            margin-bottom:15px; 
            text-align:center;
            border-bottom: 2px solid #EEE;
            padding-bottom: 8px;
        }

        img { 
            display:block; 
            max-width:100%; 
            margin:25px auto; 
            border-radius:15px; 
            border:3px solid #6A5ACD;
            box-shadow:0 10px 30px rgba(0,0,0,0.1); 
        }

        .chart-placeholder {
            min-height: 250px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            background: #F0F4F8; /* Ù„ÙˆÙ† ÙØ§ØªØ­ Ù„Ù„Ø®Ù„ÙÙŠØ© */
            color: #6A5ACD; /* Ù„ÙˆÙ† Ø¨Ù†ÙØ³Ø¬ÙŠ Ù„Ù„Ù†Øµ */
            border-radius: 15px;
            margin: 25px auto;
            border: 3px dashed #BA55D3; /* Ø¥Ø·Ø§Ø± Ù…ØªÙ‚Ø·Ø¹ Ø¨Ù†ÙØ³Ø¬ÙŠ */
            font-weight: 700;
            font-size: 18px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }

        .chart-placeholder strong {
            display: block;
            margin-bottom: 10px;
            font-size: 20px;
        }

        .planet-symbol { 
            font-size:22px; 
            font-weight:700; 
            color:#FFD700;
        }

        .dst-notice {
            background:#FFF3CD;
            padding:15px; 
            border-radius:10px; 
            margin:15px 0;
            text-align:center; 
            color:#856404; 
            border:1px solid #FFEEBA;
            font-weight: bold;
        }

        /* ØªØµÙ…ÙŠÙ… Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© */
        @media (max-width:768px){
            .header-section h1{ font-size:30px; }
            .calculator-box{ padding:20px; }
            .form-row{ grid-template-columns: repeat(2,1fr); gap:10px; }
            .form-row.double{ grid-template-columns: 1fr; }
            input, select, .btn{ padding:10px; font-size:16px; }
            th, td{ padding:8px 4px; font-size:13px; }
        }
        @media (max-width:480px){
            .form-row{ grid-template-columns:1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header-section">
            <h1>Ø§ÙƒØªØ´Ù Ø®Ø±ÙŠØ·ØªÙƒ Ø§Ù„ÙÙ„ÙƒÙŠØ©!</h1>
            <p>Ø£Ø¯Ø®Ù„ ØªÙØ§ØµÙŠÙ„ Ù…ÙŠÙ„Ø§Ø¯Ùƒ Ø§Ù„Ø¯Ù‚ÙŠÙ‚Ø© (Ø§Ù„ØªØ§Ø±ÙŠØ®ØŒ Ø§Ù„ÙˆÙ‚ØªØŒ ÙˆØ§Ù„Ù…ÙƒØ§Ù†) Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ØªÙ‚Ø±ÙŠØ± ÙÙ„ÙƒÙŠ Ø´Ø§Ù…Ù„.</p>
        </div>

        <div class="calculator-box">
            <form method="post">
                <h2 class="box-title">ğŸª Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø®Ø±ÙŠØ·Ø© Ø§Ù„ÙÙ„ÙƒÙŠØ©</h2>
                <div class="form-row">
                    <div class="form-group">
                        <label for="day">Ø§Ù„ÙŠÙˆÙ…:</label>
                        <input type="number" id="day" name="day" min="1" max="31" value="{{ input_data.day if input_data else '' }}" required>
                    </div>
                    <div class="form-group">
                        <label for="month">Ø§Ù„Ø´Ù‡Ø±:</label>
                        <input type="number" id="month" name="month" min="1" max="12" value="{{ input_data.month if input_data else '' }}" required>
                    </div>
                    <div class="form-group">
                        <label for="year">Ø§Ù„Ø³Ù†Ø©:</label>
                        <input type="number" id="year" name="year" value="{{ input_data.year if input_data else '' }}" required>
                    </div>
                    <div class="form-group">
                        <label for="house_system">Ù†Ø¸Ø§Ù… Ø§Ù„Ø¨ÙŠÙˆØª:</label>
                        <select id="house_system" name="house_system">
                            <option value="P" {% if input_data and input_data.get('house_system') == 'P' %}selected{% elif not input_data %}selected{% endif %}>Ø¨Ù„Ø§Ø³ÙŠØ¯ÙˆØ³</option>
                            <option value="W" {% if input_data and input_data.get('house_system') == 'W' %}selected{% endif %}>Ø§Ù„Ø¨Ø±Ø¬ Ø§Ù„ÙƒØ§Ù…Ù„</option>
                            <option value="E" {% if input_data and input_data.get('house_system') == 'E' %}selected{% endif %}>Ø§Ù„Ø¨ÙŠÙˆØª Ø§Ù„Ù…ØªØ³Ø§ÙˆÙŠØ©</option>
                            <option value="K" {% if input_data and input_data.get('house_system') == 'K' %}selected{% endif %}>ÙƒÙˆØ®</option>
                        </select>
                    </div>
                </div>

                <div class="form-row double">
                    <div class="form-group">
                        <label for="hour">Ø§Ù„Ø³Ø§Ø¹Ø© (24):</label>
                        <input type="number" id="hour" name="hour" min="0" max="23" value="{{ input_data.hour if input_data else '' }}" required>
                    </div>
                    <div class="form-group">
                        <label for="minute">Ø§Ù„Ø¯Ù‚ÙŠÙ‚Ø©:</label>
                        <input type="number" id="minute" name="minute" min="0" max="59" value="{{ input_data.minute if input_data else '' }}" required>
                    </div>
                </div>

                <div class="form-row double">
                    <div class="form-group">
                        <label for="city">Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©:</label>
                        <input type="text" id="city" name="city" value="{{ input_data.city if input_data else '' }}" autocomplete="off" required>
                    </div>
                    <div class="form-group">
                        <label for="country">Ø§Ù„Ø¯ÙˆÙ„Ø©:</label>
                        <input type="text" id="country" name="country" value="{{ input_data.country if input_data else '' }}" required>
                    </div>
                </div>

                <button class="btn" type="submit">Ø§Ø­Ø³Ø¨ Ø®Ø±ÙŠØ·ØªÙŠ Ø§Ù„ÙÙ„ÙƒÙŠØ©</button>
            </form>

            {% if error %}
                <div class="error" style="margin-top:12px;">{{ error }}</div>
            {% endif %}
        </div>

        {% if result %}
        <div class="result">
            <h2>ğŸ“ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø®Ø±ÙŠØ·Ø© Ø§Ù„ÙÙ„ÙƒÙŠØ© Ù„Ù€ {{ result.location }}</h2>
            <div class="info-box">
                <strong>Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø­Ù„ÙŠ:</strong> {{ result.local_time }} |
                <strong>Ø§Ù„Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø²Ù…Ù†ÙŠØ©:</strong> {{ result.timezone }}<br>
                <strong>ÙˆÙ‚Øª UTC:</strong> {{ result.utc_time }}
            </div>

            {% if result.dst_notice %}
            <div class="dst-notice">{{ result.dst_notice }}</div>
            {% endif %}

            <h3>â­ Ø§Ù„Ø²ÙˆØ§ÙŠØ§ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</h3>
            <table>
                <tr>
                    <th>Ø§Ù„Ø²Ø§ÙˆÙŠØ©</th><th>Ø§Ù„Ø§Ø³Ù… Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</th><th>Ø§Ù„Ø¯Ø±Ø¬Ø© Ø§Ù„ÙƒÙ„ÙŠØ©</th><th>Ø§Ù„Ø¯Ø±Ø¬Ø© ÙÙŠ Ø§Ù„Ø¨Ø±Ø¬</th><th>Ø§Ù„Ø¨Ø±Ø¬</th><th>Ø§Ù„Ø±Ù…Ø²</th>
                </tr>
                {% for key, angle in result.angles.items() %}
                <tr>
                    <td><strong>{{ key }}</strong></td>
                    <td>{{ angle.name_ar }}</td>
                    <td>{{ "%.2fÂ°"|format(angle.degree) }}</td>
                    <td>{{ "%.2fÂ°"|format(angle.sign_info.degree_in_sign) }}</td>
                    <td>{{ angle.sign_info.sign_ar }}</td>
                    <td class="planet-symbol">{{ angle.sign_info.sign_symbol }}</td>
                </tr>
                {% endfor %}
            </table>

            <h3>ğŸª Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„ÙƒÙˆØ§ÙƒØ¨</h3>
            <table>
                <tr><th>Ø§Ù„ÙƒÙˆÙƒØ¨</th><th>Ø§Ù„Ø±Ù…Ø²</th><th>Ø§Ù„Ø¯Ø±Ø¬Ø© Ø§Ù„ÙƒÙ„ÙŠØ©</th><th>Ø§Ù„Ø¯Ø±Ø¬Ø© ÙÙŠ Ø§Ù„Ø¨Ø±Ø¬</th><th>Ø§Ù„Ø¨Ø±Ø¬</th><th>Ø±Ù…Ø² Ø§Ù„Ø¨Ø±Ø¬</th><th>Ø§Ù„Ø¨ÙŠØª</th></tr>
                {% for planet in result.planets %}
                <tr>
                    <td>{{ planet.name_ar }}</td>
                    <td class="planet-symbol">{{ planet.symbol }}</td>
                    <td>{{ "%.2fÂ°"|format(planet.degree) }}</td>
                    <td>{{ "%.2fÂ°"|format(planet.degree_in_sign) }}</td>
                    <td>{{ planet.sign_ar }}</td>
                    <td class="planet-symbol">{{ planet.sign_symbol }}</td>
                    <td><strong>{{ planet.house }}</strong></td>
                </tr>
                {% endfor %}
            </table>

            <h3>ğŸ  Ø§Ù„Ø¨ÙŠÙˆØª Ø§Ù„ÙÙ„ÙƒÙŠØ© (Ù†Ø¸Ø§Ù…: {{ result.house_system }})</h3>
            <table>
                <tr><th>Ø§Ù„Ø¨ÙŠØª</th><th>Ø§Ù„Ø§Ø³Ù…</th><th>Ø§Ù„Ø¯Ø±Ø¬Ø© Ø§Ù„ÙƒÙ„ÙŠØ©</th><th>Ø§Ù„Ø¯Ø±Ø¬Ø© ÙÙŠ Ø§Ù„Ø¨Ø±Ø¬</th><th>Ø§Ù„Ø¨Ø±Ø¬</th><th>Ø§Ù„Ø±Ù…Ø²</th></tr>
                {% for house in result.houses_info %}
                <tr>
                    <td><strong>{{ house.house }}</strong></td>
                    <td>{{ house.name_ar }}</td>
                    <td>{{ "%.2fÂ°"|format(house.degree) }}</td>
                    <td>{{ "%.2fÂ°"|format(house.degree_in_sign) }}</td>
                    <td>{{ house.sign_ar }}</td>
                    <!-- ØªÙ… ØªØµØ­ÙŠØ­ Ø§Ù„Ø®Ø·Ø£ Ù‡Ù†Ø§: Ø£ØµØ¨Ø­ Ø§Ù„ÙˆØµÙˆÙ„ Ù…Ø¨Ø§Ø´Ø±Ù‹Ø§ Ù„Ù€ sign_symbol -->
                    <td class="planet-symbol">{{ house.sign_symbol }}</td>
                </tr>
                {% endfor %}
            </table>

            <h3>ğŸŒŒ Ø§Ù„Ø®Ø±ÙŠØ·Ø© Ø§Ù„ÙÙ„ÙƒÙŠØ© Ø§Ù„Ù…ØµÙˆØ±Ø©</h3>
            {% if chart %}
                <img src="data:image/png;base64,{{ chart }}" alt="Ø§Ù„Ø®Ø±ÙŠØ·Ø© Ø§Ù„ÙÙ„ÙƒÙŠØ©">
            {% else %}
                <div class="chart-placeholder">
                    <strong>âš ï¸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø¹Ø±Ø¶ Ø§Ù„Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠØ© ÙÙŠ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªÙ…Ù‡ÙŠØ¯ÙŠ</strong><br>
                    Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù‡Ø°Ù‡ Ø§Ù„ØµÙˆØ±Ø© Ø¨Ø´ÙƒÙ„ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ Ø¨ÙˆØ§Ø³Ø·Ø© ØªØ·Ø¨ÙŠÙ‚ Flask (Python) Ø¹Ù†Ø¯ ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚.
                </div>
            {% endif %}
        </div>
        {% endif %}
    </div>
    
</body>
</html>